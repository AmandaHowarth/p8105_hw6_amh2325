---
title: "Untitled"
author: "Amanda Howarth"
date: "11/23/2019"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(rvest)
library(tidyverse)
library(purrr)
library(broom)
library(modelr)
library(mgcv)
library(patchwork)
```

## Importing data
```{r}
birthweight = read_csv("./data/birthweight.csv")
```
```{r}
birthweight_clean = birthweight %>% 
  janitor::clean_names() %>% 
  mutate(babysex = factor(babysex, levels = c("1", "2")),
         frace = factor(frace, levels = c("1", "2", "3", "4", "8", "9")),
         mrace = factor(mrace, levels = c("1", "2", "3", "4", "8", "9")),
         malform = factor(malform, levels = c("0", "1")),
         babysex = recode(babysex, "1" = "male", "2" = "female"), 
         frace = recode(frace, "1" = "white", "2" = "black", "3" = "asian", "4" = "puerto rican", "8" = "other", "9" = "unknown"),
         mrace = recode(mrace, "1" = "white", "2" = "black", "3" = "asian", "4" = "puerto rican", "8" = "other", "9" = "unknown"), 
         malform = recode(malform, "0" = "absent", "1" = "present")) %>%
  rename(bwt_grams = bwt, mom_weight_lbs = delwt, family_income = fincome, father_race = frace, mom_race = mrace, ges_age_weeks = gaweeks, age_menerache = menarche, mom_height = mheight, mom_age = momage, mom_pre_bmi = ppbmi)
```

## Model building
I have hypothesized that a baby's physical and biological characteristics as well as the mother's physical and biological characteristics at the time of delivery would affect the baby's weight at birth. Thus, in building my model I analyzed baby's sex, head circumference, baby length, gestational age, and presence of malformations that would affect weight. Additionally, I analyzed mother's weight, age at delivery, and height. 

* say that u removed some bc it did not increase in the R^2 
* say looked at all of them first and then chose significant ones 
* say teh R^2 value 
* reisduals ? predictions? 

```{r}
fit_bwt_model = lm(bwt_grams ~ babysex + bhead + blength + mom_weight_lbs + ges_age_weeks, data = birthweight_clean)

fit_bwt_model %>% 
  broom::tidy()

fit_bwt_model %>%
  broom::glance()

modelr::add_residuals(birthweight_clean, fit_bwt_model)

```

## Model using using length at birth and gestational age as predictors (main effects only)

```{r}
fit_2 = lm(bwt_grams ~  blength + ges_age_weeks, data = birthweight_clean)

fit_2 %>% 
  broom::tidy()
```

```{r}


```

```{r}


```

```{r}


```