Untitled
================
Amanda Howarth
11/23/2019

## Importing data

``` r
birthweight = read_csv("./data/birthweight.csv")
```

    ## Parsed with column specification:
    ## cols(
    ##   .default = col_double()
    ## )

    ## See spec(...) for full column specifications.

``` r
birthweight_clean = birthweight %>% 
  janitor::clean_names() %>% 
  mutate(babysex = factor(babysex, levels = c("1", "2")),
         frace = factor(frace, levels = c("1", "2", "3", "4", "8", "9")),
         mrace = factor(mrace, levels = c("1", "2", "3", "4", "8", "9")),
         malform = factor(malform, levels = c("0", "1")),
         babysex = recode(babysex, "1" = "male", "2" = "female"), 
         frace = recode(frace, "1" = "white", "2" = "black", "3" = "asian", "4" = "puerto rican", "8" = "other", "9" = "unknown"),
         mrace = recode(mrace, "1" = "white", "2" = "black", "3" = "asian", "4" = "puerto rican", "8" = "other", "9" = "unknown"), 
         malform = recode(malform, "0" = "absent", "1" = "present")) %>%
  rename(bwt_grams = bwt, mom_weight_lbs = delwt, family_income = fincome, father_race = frace, mom_race = mrace, ges_age_weeks = gaweeks, age_menerache = menarche, mom_height = mheight, mom_age = momage, mom_pre_bmi = ppbmi)
```

## Model building

I have hypothesized that a baby’s physical and biological
characteristics as well as the mother’s physical and biological
characteristics at the time of delivery would affect the baby’s weight
at birth. Thus, in building my model I analyzed baby’s sex, head
circumference, baby length, gestational age, and presence of
malformations that would affect weight. Additionally, I analyzed
mother’s weight, age at delivery, and height.

  - say that u removed some bc it did not increase in the R^2
  - say looked at all of them first and then chose significant ones
  - say teh R^2 value
  - reisduals ?
predictions?

<!-- end list -->

``` r
fit_bwt_model = lm(bwt_grams ~ babysex + bhead + blength + mom_weight_lbs + ges_age_weeks, data = birthweight_clean)

fit_bwt_model %>% 
  broom::tidy()
```

    ## # A tibble: 6 x 5
    ##   term           estimate std.error statistic   p.value
    ##   <chr>             <dbl>     <dbl>     <dbl>     <dbl>
    ## 1 (Intercept)    -6314.      96.9      -65.2  0.       
    ## 2 babysexfemale     31.8      8.74       3.64 2.75e-  4
    ## 3 bhead            138.       3.54      38.9  9.93e-285
    ## 4 blength           79.3      2.07      38.3  2.41e-276
    ## 5 mom_weight_lbs     2.03     0.199     10.2  4.75e- 24
    ## 6 ges_age_weeks     13.7      1.50       9.14 9.23e- 20

``` r
fit_bwt_model %>%
  broom::glance()
```

    ## # A tibble: 1 x 11
    ##   r.squared adj.r.squared sigma statistic p.value    df  logLik    AIC
    ##       <dbl>         <dbl> <dbl>     <dbl>   <dbl> <int>   <dbl>  <dbl>
    ## 1     0.696         0.696  282.     1989.       0     6 -30661. 61336.
    ## # … with 3 more variables: BIC <dbl>, deviance <dbl>, df.residual <int>

``` r
modelr::add_residuals(birthweight_clean, fit_bwt_model)
```

    ## # A tibble: 4,342 x 21
    ##    babysex bhead blength bwt_grams mom_weight_lbs family_income father_race
    ##    <fct>   <dbl>   <dbl>     <dbl>          <dbl>         <dbl> <fct>      
    ##  1 female     34      51      3629            177            35 white      
    ##  2 male       34      48      3062            156            65 black      
    ##  3 female     36      50      3345            148            85 white      
    ##  4 male       34      52      3062            157            55 white      
    ##  5 female     34      52      3374            156             5 white      
    ##  6 male       33      52      3374            129            55 white      
    ##  7 female     33      46      2523            126            96 black      
    ##  8 female     33      49      2778            140             5 white      
    ##  9 male       36      52      3515            146            85 white      
    ## 10 male       33      50      3459            169            75 black      
    ## # … with 4,332 more rows, and 14 more variables: ges_age_weeks <dbl>,
    ## #   malform <fct>, age_menerache <dbl>, mom_height <dbl>, mom_age <dbl>,
    ## #   mom_race <fct>, parity <dbl>, pnumlbw <dbl>, pnumsga <dbl>,
    ## #   mom_pre_bmi <dbl>, ppwt <dbl>, smoken <dbl>, wtgain <dbl>, resid <dbl>

## Model using using length at birth and gestational age as predictors (main effects only)

``` r
fit_2 = lm(bwt_grams ~  blength + ges_age_weeks, data = birthweight_clean)

fit_2 %>% 
  broom::tidy()
```

    ## # A tibble: 3 x 5
    ##   term          estimate std.error statistic  p.value
    ##   <chr>            <dbl>     <dbl>     <dbl>    <dbl>
    ## 1 (Intercept)    -4348.      98.0      -44.4 0.      
    ## 2 blength          129.       1.99      64.6 0.      
    ## 3 ges_age_weeks     27.0      1.72      15.7 2.36e-54
